import sys
import pandas as pd
import itertools
import scipy
from scipy import stats
import numpy as np

# include gap in valid aa
valid_aa =["X", "A","R","N","D","C","Q","E","G","H","I","L","K","M","F","P","S","T","W","Y","V" ]
d_aa_int = { aa:valid_aa.index(aa) for aa in valid_aa }
d_int_aa= { valid_aa.index(aa):aa for aa in valid_aa }
d_3to1= {'A':'ALA','C':'CYS','D':'ASP','E':'GLU','F':'PHE','G':'GLY','H':'HIS','I':'ILE','K':'LYS','L':'LEU','M':'MET','N':'ASN','P':'PRO','Q':'GLN','R':'ARG','S':'SER','T':'THR','V':'VAL','W':'TRP','Y':'TYR', 'X':'X'}
#num aa
q_aa = len(valid_aa)


def compute_dist(ref_seq, seq):
    distance = sum([1 for x, y in zip(ref_seq, seq) if x.lower() != y.lower()])
    return distance

def compute_seqid_single_seq(ref_seq, seq, no_pad= True):
    '''return the sequence identity (seqid) '''
    if no_pad:
        ref_seq = ref_seq.replace("X","")
        seq = seq.replace("X","")
    distance = compute_dist(ref_seq,seq)
    distance /= len(seq)
    seqid = 1 - distance
    return seqid

def compute_seqid(seq_input_list, seq_output_list):
    all_seqid = []
    for seq1, seq2 in zip(seq_input_list, seq_output_list):
        all_seqid.append(compute_seqid_single_seq(seq1,seq2))
    return all_seqid

def all_standard_aa(seq):
    '''return True if sequence contains only standard-aa'''
    if type(seq) != str:
        return False
    for char in seq:
        if((char not in valid_aa) and char !='-'):
            #print("seq containing non standard aa: "+char)
            return False
            break
    return True

def clean_aaseq(df, col_name):
    df_clean = df.loc[df[col_name].apply(lambda x:all_standard_aa(x))]
    if len(df) != len(df_clean):
        print('*** WARNING *** {0} contains non-standard aa! REMOVING THEM!'.format(col_name))
        print('removed {0} seq from column {1}'.format(len(df) - len(df_clean), col_name))
    return df_clean

def check_only_standard_aa(df, col_name):
    df_clean = df.loc[df[col_name].apply(lambda x:all_standard_aa(x))]
    if len(df) != len(df_clean):
        print('***ERROR*** {0} contains non-standard aa! EXIT!'.format(col_name))
        print('*** remove them and re-run ***')
        print(pd.concat([df,df_clean]).drop_duplicates(keep=False))
        sys.exit(0)
        return 0

def correct_gene_name(map_gene, gene):
    if gene!= gene: #if nan
        return np.nan
    gene_name = gene.split("*")[0]
    #keep the same allele
    if len(gene.split("*")) > 1:
        allele_name = '*' + gene.split("*")[1]
    else:
        allele_name = ''
    if gene_name in map_gene.keys():
        gene_name_corr = map_gene.get(gene_name)
        gene_name_corr += allele_name
    else:
        gene_name_corr = gene_name + allele_name
    #print(gene_name, gene_name_corr)
    return gene_name_corr

def compute_perc_rank(model_name, d_model_anc, predicted_scores):
    anch_scores = d_model_anc[model_name][1]
    anch_perc_rank = d_model_anc[model_name][0]
    indices = np.digitize(predicted_scores, anch_scores)
    all_perc_rank = []
    for score, idx in zip(predicted_scores, indices):
        #print(score,idx)
        if idx == len(anch_scores):
            perc_rank = np.min(anch_perc_rank)
            all_perc_rank.append(perc_rank)
            #print('very good_seq...', score,perc_rank)
        if idx == 0:
            perc_rank = np.max(anch_perc_rank)
            all_perc_rank.append(perc_rank)
            #print('very bad_seq...', score,perc_rank)
        if (idx != len(anch_scores)) & (idx != 0):
            #do linear interpolation
            #(x1,y1), (x2,y2)
            #y = ((y1-y2)/(x1-x2))*x + ((y2*x1 - y1*x2)/(x1-x2))
            x1,y1 = anch_scores[idx], anch_perc_rank[idx]
            x2,y2 = anch_scores[idx-1], anch_perc_rank[idx-1]
            #print(x1,y1)
            #print(x2,y2)
            perc_rank = ((y1-y2)/(x1-x2))*score + ((y2*x1 - y1*x2)/(x1-x2))
            #print(score,perc_rank)
            all_perc_rank.append(perc_rank)
    return all_perc_rank

#### to map to perc rank
# DEPRECATED -> now compute  %rank from scores of 10.000 random ab TCRs
#def get_perc_rank(score, epi, d_par, distr = stats.exponnorm):
#    mean, std, popt1, popt2, popt3 = d_par.get(epi, [-1,-1,-1,-1,-1])
#    if mean==std==popt1==popt2==popt3 == -1:
#        pr = -1
#        return pr
#    else:
#        popt = (popt1, popt2, popt3)
#        score_test = (score - mean) / std
#        pr = 1 - distr.cdf(score, *popt)#scipy.stats.percentileofscore(list_score_ref, score)
#        pr = pr*100
#        return pr

#####################################################################################################
#OLD: to rm
#####################################################################################################
## for token generation
#def make_dictionary_tok_int(n_ngrams):
#    all_possible_token = []
#    #for comb in itertools.combinations(valid_aa, n):
#    for tok in itertools.product(valid_aa, repeat=n_ngrams):
#        tok = ''.join(tok)
#        all_possible_token.append(tok)
#    d_tok_int = {tok:i for i,tok in enumerate(all_possible_token)}
#    return d_tok_int
#
#def generate_ngrams(seq, n):
#    tokens = [token for token in list(seq) if token != ""]
#    ngrams = zip(*[tokens[i:] for i in range(n)])
#    return [''.join(ngram) for ngram in ngrams]
####################################################################################################
# to integrate CDR1/2 (from Vgenes: check ./src/imgt)

####################################################################################################
### HOMO SAPIENS
####################################################################################################
d_trav_cdr1_homo_sapiens = {"TRAV1-1*01":"TSGFYG","TRAV1-1*02":"TSGFYG","TRAV1-2*01":"TSGFNG","TRAV1-2*02":"TSGFNG","TRAV1-2*03":"TSGFNG","TRAV10*01":"VSPFSN","TRAV10*02":"VSPFSN","TRAV11*01":"ERTLFN","TRAV12-1*01":"NSASQS","TRAV12-1*02":"NSASQS","TRAV12-2*01":"DRGSQS","TRAV12-2*02":"DRGSQS","TRAV12-2*03":"DRVSQS","TRAV12-3*01":"NSAFQY","TRAV12-3*02":"NSAFQY","TRAV13-1*01":"DSASNY","TRAV13-1*02":"DSASNY","TRAV13-1*03":"DSASNY","TRAV13-2*01":"NSASDY","TRAV13-2*02":"NSASDY","TRAV14/DV4*01":"TSDPSYG","TRAV14/DV4*02":"TSDQSYG","TRAV14/DV4*03":"TSDPSYG","TRAV14/DV4*04":"TSDQSYG","TRAV16*01":"YSGSPE","TRAV17*01":"TSINN","TRAV18*01":"SSYSTF","TRAV19*01":"TRDTTYY","TRAV2*01":"VSNAYN","TRAV2*02":"VSNAYN","TRAV20*01":"VSGLRG","TRAV20*02":"VSGLRG","TRAV20*03":"VSGLRG","TRAV20*04":"VSGLRG","TRAV21*01":"DSAIYN","TRAV21*02":"DSAIYN","TRAV22*01":"DSVNN","TRAV23/DV6*01":"NTAFDY","TRAV23/DV6*02":"NTAFDY","TRAV23/DV6*03":"NTAFDY","TRAV23/DV6*04":"NTAFDY","TRAV23/DV6*05":"NTAFDY","TRAV24*01":"SSNFYA","TRAV24*02":"SSNFYA","TRAV25*01":"TTLSN","TRAV26-1*01":"TISGNEY","TRAV26-1*02":"TISGNEY","TRAV26-1*03":"TISGNEY","TRAV26-2*01":"TISGTDY","TRAV26-2*02":"TISGTDY","TRAV27*01":"SVFSS","TRAV27*02":"SVFSS","TRAV27*03":"SVFSS","TRAV29/DV5*01":"NSMFDY","TRAV29/DV5*02":"NSMFDY","TRAV29/DV5*04":"NSMFDY","TRAV3*01":"VSGNPY","TRAV30*01":"KALYS","TRAV30*02":"KALYS","TRAV30*03":"KALYS","TRAV30*04":"KALYS","TRAV30*05":"KALYS","TRAV34*01":"KTLYG","TRAV35*01":"SIFNT","TRAV35*02":"SIFNT","TRAV35*03":"SIFNT","TRAV36/DV7*01":"VTNFRS","TRAV36/DV7*02":"MTNFRS","TRAV36/DV7*03":"VTNFRS","TRAV36/DV7*04":"VTNFRS","TRAV36/DV7*05":"VTNFRS","TRAV38-1*01":"TSENNYY","TRAV38-1*02":"TSENDYY","TRAV38-1*03":"TSESNYY","TRAV38-1*04":"TSENNYY","TRAV38-2/DV8*01":"TSESDYY","TRAV39*01":"TTSDR","TRAV4*01":"NIATNDY","TRAV40*01":"STGYPT","TRAV41*01":"VGISA","TRAV5*01":"DSSSTY","TRAV6*01":"NYSPAY","TRAV6*02":"NYSPAY","TRAV6*03":"NYSPAY","TRAV6*04":"NYSPAY","TRAV6*05":"NYSPAY","TRAV6*06":"NYSPAY","TRAV6*07":"NYSPAY","TRAV7*01":"VSRFNN","TRAV8-1*01":"YGGTVN","TRAV8-1*02":"YGGTVN","TRAV8-2*01":"SSYSPS","TRAV8-2*02":"SSYSPS","TRAV8-2*03":"SSYSPS","TRAV8-3*01":"YGATPY","TRAV8-3*02":"YGATPY","TRAV8-3*03":"YGATPY","TRAV8-4*01":"SSVPPY","TRAV8-4*02":"SSVPPY","TRAV8-4*03":"SSVPPY","TRAV8-4*04":"SSVPPY","TRAV8-4*05":"SSVPPY","TRAV8-4*06":"YCCPPI","TRAV8-4*07":"VEPY","TRAV8-6*01":"SSVSVY","TRAV8-6*02":"SSVSVY","TRAV8-7*01":"YSGVPS","TRAV8-7*02":"YSGVPS","TRAV9-1*01":"TTQYPS","TRAV9-2*01":"ATGYPS","TRAV9-2*02":"ATGYPS","TRAV9-2*03":"ATGYPS","TRAV9-2*04":"ATGYPS"}

d_trav_cdr2_homo_sapiens = {"TRAV1-1*01":"NALDGL","TRAV1-1*02":"NGLDGL","TRAV1-2*01":"NVLDGL","TRAV1-2*02":"NVLDGL","TRAV1-2*03":"NVLDGL","TRAV10*01":"MTFSENT","TRAV10*02":"MTFSENT","TRAV11*01":"IQSSQKE","TRAV12-1*01":"VYSSGN","TRAV12-1*02":"VYSSGN","TRAV12-2*01":"IYSNGD","TRAV12-2*02":"IYSNGD","TRAV12-2*03":"IYSNGD","TRAV12-3*01":"TYSSGN","TRAV12-3*02":"TYSSGN","TRAV13-1*01":"IRSNVGE","TRAV13-1*02":"IRSNVGE","TRAV13-1*03":"IRSNVGE","TRAV13-2*01":"IRSNMDK","TRAV13-2*02":"IRSNMDK","TRAV14/DV4*01":"QGSYDQQN","TRAV14/DV4*02":"QGSYDEQN","TRAV14/DV4*03":"QGSYDQQN","TRAV14/DV4*04":"QGSYDEQN","TRAV16*01":"HISR","TRAV17*01":"IRSNERE","TRAV18*01":"SSENQE","TRAV19*01":"RNSFDEQN","TRAV2*01":"GSKP","TRAV2*02":"GSKP","TRAV20*01":"LYSAGEE","TRAV20*02":"LYSAGEE","TRAV20*03":"LYSAGEE","TRAV20*04":"LYSAGEE","TRAV21*01":"IQSSQRE","TRAV21*02":"IQSSQRE","TRAV22*01":"IPSGT","TRAV23/DV6*01":"IRPDVSE","TRAV23/DV6*02":"IRPDVSE","TRAV23/DV6*03":"IRPDVSE","TRAV23/DV6*04":"IRPDVSE","TRAV23/DV6*05":"IRPDVSE","TRAV24*01":"MTLNGDE","TRAV24*02":"MTLNGDE","TRAV25*01":"LVKSGEV","TRAV26-1*01":"GLKNN","TRAV26-1*02":"GLKNN","TRAV26-1*03":"GLKNN","TRAV26-2*01":"GLTSN","TRAV26-2*02":"GLTSN","TRAV27*01":"VVTGGEV","TRAV27*02":"VVTGGEV","TRAV27*03":"VVTGGEV","TRAV29/DV5*01":"ISSIKDK","TRAV29/DV5*02":"ISSIKDK","TRAV29/DV5*04":"ISSIKDK","TRAV3*01":"YITGDNLV","TRAV30*01":"LLKGGEQ","TRAV30*02":"LLKGGEQ","TRAV30*03":"LLKGGEQ","TRAV30*04":"LLKGGEQ","TRAV30*05":"LLKGGEQ","TRAV34*01":"LQKGGEE","TRAV35*01":"LYKAGEL","TRAV35*02":"LYKAGEL","TRAV35*03":"LYKAGEL","TRAV36/DV7*01":"LTSSGIE","TRAV36/DV7*02":"LTSSGIE","TRAV36/DV7*03":"LTSSGIE","TRAV36/DV7*04":"LTSSGIE","TRAV36/DV7*05":"LTSSGIE","TRAV38-1*01":"QEAYKQQN","TRAV38-1*02":"QEAYKQQN","TRAV38-1*03":"QEAYKQQN","TRAV38-1*04":"QEAYKQQN","TRAV38-2/DV8*01":"QEAYKQQN","TRAV39*01":"LLSNGAV","TRAV4*01":"GYKTK","TRAV40*01":"ETME","TRAV41*01":"LSSGK","TRAV5*01":"IFSNMDM","TRAV6*01":"IRENEKE","TRAV6*02":"IRENEKE","TRAV6*03":"IRENEKE","TRAV6*04":"IRENEKE","TRAV6*05":"IRENEKE","TRAV6*06":"IRENEKE","TRAV6*07":"IRENEKE","TRAV7*01":"MYSAGYE","TRAV8-1*01":"YFSGDPLV","TRAV8-1*02":"YFSGDPLV","TRAV8-2*01":"YTSAATLV","TRAV8-2*02":"YTSAATLV","TRAV8-2*03":"YTSAATLV","TRAV8-3*01":"YFSGDTLV","TRAV8-3*02":"YFSGDTLV","TRAV8-3*03":"YFSGDTLV","TRAV8-4*01":"YTSAATLV","TRAV8-4*02":"YTSAATLV","TRAV8-4*03":"YTTGATLV","TRAV8-4*04":"YTSAATLV","TRAV8-4*05":"YTSAATLV","TRAV8-4*06":"YTSAATLV","TRAV8-4*07":"YTTGATLV","TRAV8-6*01":"YLSGSTLV","TRAV8-6*02":"YLSGSTLV","TRAV8-7*01":"DLTEATQV","TRAV8-7*02":"DLTKATQV","TRAV9-1*01":"AMKANDK","TRAV9-2*01":"ATKADDK","TRAV9-2*02":"ATKADDK","TRAV9-2*03":"ATKADDK","TRAV9-2*04":"ATKADDK"}

d_trbv_cdr1_homo_sapiens = {"TRBV1*01":"GHDS","TRBV10-1*01":"WNHNN","TRBV10-1*02":"WNHNN","TRBV10-2*01":"WSHSY","TRBV10-2*02":"WSHSY","TRBV10-3*01":"ENHRY","TRBV10-3*02":"ENHRY","TRBV10-3*03":"ENHRY","TRBV10-3*04":"ENHRY","TRBV11-1*01":"SGHAT","TRBV11-2*01":"SGHAT","TRBV11-2*02":"SGHAT","TRBV11-2*03":"SGHAT","TRBV11-3*01":"SGHNT","TRBV11-3*02":"SGHNT","TRBV11-3*03":"SGHNT","TRBV11-3*04":"SGHNT","TRBV12-1*01":"SGHND","TRBV12-2*01":"FGHNF","TRBV12-3*01":"SGHNS","TRBV12-4*01":"SGHDY","TRBV12-4*02":"SGHDY","TRBV12-5*01":"LGHNT","TRBV13*01":"PRHDT","TRBV13*02":"PRHDT","TRBV14*01":"SGHDN","TRBV14*02":"SGHDN","TRBV15*01":"LNHNV","TRBV15*02":"LNHNV","TRBV15*03":"LNHNV","TRBV16*01":"KGHSY","TRBV16*02":"KGHS*","TRBV16*03":"KGHSY","TRBV17*01":"SGHMF","TRBV17*02":"SGHMF","TRBV18*01":"KGHSH","TRBV19*01":"LNHDA","TRBV19*02":"LNHDA","TRBV19*03":"LNHDA","TRBV2*01":"SNHLY","TRBV2*02":"SNHLY","TRBV2*03":"SNHLY","TRBV20-1*01":"DFQATT","TRBV20-1*02":"DFQATT","TRBV20-1*03":"DFQATT","TRBV20-1*04":"DFQATT","TRBV20-1*05":"DFQATT","TRBV20-1*06":"DFQATT","TRBV20-1*07":"DFQATT","TRBV20/OR9-2*01":"DFQATT","TRBV20/OR9-2*02":"DFQATT","TRBV20/OR9-2*03":"DFQATT","TRBV21-1*01":"KAHSY","TRBV21-1*02":"KAHSY","TRBV21/OR9-2*01":"KRHSY","TRBV23-1*01":"KGHTF","TRBV23/OR9-2*01":"NGHTF","TRBV23/OR9-2*02":"NGHTF","TRBV24-1*01":"KGHDR","TRBV24-1*02":"KGHDR","TRBV24/OR9-2*01":"KGHDR","TRBV25-1*01":"MGHDK","TRBV26*01":"MNHVT","TRBV26/OR9-2*01":"MNHVA","TRBV26/OR9-2*02":"MNHVA","TRBV27*01":"MNHEY","TRBV28*01":"MDHEN","TRBV29-1*01":"SQVTM","TRBV29-1*02":"SQVTM","TRBV29-1*03":"SQVTM","TRBV29/OR9-2*01":"SQVTM","TRBV29/OR9-2*02":"SQVTM","TRBV3-1*01":"LGHDT","TRBV3-1*02":"LGHDT","TRBV3-2*01":"LGHNA","TRBV3-2*02":"LGHNA","TRBV3-2*03":"LGHNA","TRBV30*01":"GTSNPN","TRBV30*02":"GTSNPN","TRBV30*03":"GTSNPN","TRBV30*04":"GTSNPN","TRBV30*05":"GTSNPN","TRBV4-1*01":"MGHRA","TRBV4-1*02":"MGHRA","TRBV4-2*01":"LGHNA","TRBV4-2*02":"LGHNA","TRBV4-3*01":"LGHNA","TRBV4-3*02":"LGHNA","TRBV4-3*03":"LGHNA","TRBV4-3*04":"LGHNA","TRBV5-1*01":"SGHRS","TRBV5-1*02":"SGHRS","TRBV5-3*01":"SGHSS","TRBV5-3*02":"SGHSS","TRBV5-4*01":"SGHNT","TRBV5-4*02":"SGHNT","TRBV5-4*03":"SGHNT","TRBV5-4*04":"T","TRBV5-5*01":"SGHKS","TRBV5-5*02":"SGHKS","TRBV5-5*03":"SEHKS","TRBV5-6*01":"SGHDT","TRBV5-7*01":"SGHTS","TRBV5-8*01":"SGHTS","TRBV5-8*02":"SGHTS","TRBV6-1*01":"MNHNS","TRBV6-2*01":"MNHEY","TRBV6-3*01":"MNHEY","TRBV6-4*01":"MRHNA","TRBV6-4*02":"MRHNA","TRBV6-5*01":"MNHEY","TRBV6-6*01":"MNHNY","TRBV6-6*02":"MNHNY","TRBV6-6*03":"MNHNY","TRBV6-6*04":"MNHEY","TRBV6-6*05":"MNHNY","TRBV6-7*01":"MNHEY","TRBV6-8*01":"MNHGY","TRBV6-9*01":"MNHGY","TRBV7-1*01":"SGHNA","TRBV7-2*01":"SGHTA","TRBV7-2*02":"SGHTA","TRBV7-2*03":"SGHTA","TRBV7-2*04":"SGHTA","TRBV7-3*01":"SGHTA","TRBV7-3*02":"SGHTA","TRBV7-3*03":"SGHTA","TRBV7-3*04":"SGHTA","TRBV7-3*05":"SGHTA","TRBV7-4*01":"SGHVT","TRBV7-6*01":"SGHVS","TRBV7-6*02":"SGHVS","TRBV7-7*01":"SSHAT","TRBV7-7*02":"SSHVT","TRBV7-8*01":"SGHVS","TRBV7-8*02":"SGHVS","TRBV7-8*03":"SGHVS","TRBV7-9*01":"SEHNR","TRBV7-9*02":"SEHNR","TRBV7-9*03":"SEHNR","TRBV7-9*04":"SEHNR","TRBV7-9*05":"SEHNR","TRBV7-9*06":"SEHNR","TRBV7-9*07":"HNR","TRBV9*01":"SGDLS","TRBV9*02":"SGDLS","TRBV9*03":"SGDLS"}

d_trbv_cdr2_homo_sapiens = {"TRBV1*01":"YNCKEF","TRBV10-1*01":"SYGVQD","TRBV10-1*02":"SYGVHD","TRBV10-2*01":"SAAADI","TRBV10-2*02":"SAAADI","TRBV10-3*01":"SYGVKD","TRBV10-3*02":"SYGVKD","TRBV10-3*03":"SYGVKD","TRBV10-3*04":"SYGVKD","TRBV11-1*01":"FQDESV","TRBV11-2*01":"FQNNGV","TRBV11-2*02":"FQNNGV","TRBV11-2*03":"FQNNGV","TRBV11-3*01":"YENEEA","TRBV11-3*02":"YENEEA","TRBV11-3*03":"YENEEA","TRBV11-3*04":"YENEEA","TRBV12-1*01":"FCSWTL","TRBV12-2*01":"FRS*SI","TRBV12-3*01":"FNNNVP","TRBV12-4*01":"FNNNVP","TRBV12-4*02":"FNNNVP","TRBV12-5*01":"FRNRAP","TRBV13*01":"FYEKMQ","TRBV13*02":"FYEKMQ","TRBV14*01":"FVKESK","TRBV14*02":"FVKESK","TRBV15*01":"YYDKDF","TRBV15*02":"YYDKDF","TRBV15*03":"YYNKDF","TRBV16*01":"FQNENV","TRBV16*02":"FQNENV","TRBV16*03":"FQNENV","TRBV17*01":"FQYQNI","TRBV17*02":"FQYQNI","TRBV18*01":"LQKENI","TRBV19*01":"SQIVND","TRBV19*02":"SHIVND","TRBV19*03":"SHIVND","TRBV2*01":"FYNNEI","TRBV2*02":"FYNNEI","TRBV2*03":"FYNNEI","TRBV20-1*01":"SNEGSKA","TRBV20-1*02":"SNEGSKA","TRBV20-1*03":"SNEGCKA","TRBV20-1*04":"SNEGSKA","TRBV20-1*05":"SNEGSKA","TRBV20-1*06":"SNEGSKA","TRBV20-1*07":"SNEGSKA","TRBV20/OR9-2*01":"SNEGSEV","TRBV20/OR9-2*02":"SNEGSEV","TRBV20/OR9-2*03":"SNEGSEV","TRBV21-1*01":"FQNEEL","TRBV21-1*02":"FQNEEL","TRBV21/OR9-2*01":"FQNEEI","TRBV23-1*01":"FQNEQV","TRBV23/OR9-2*01":"FQNEQV","TRBV23/OR9-2*02":"FQNEQV","TRBV24-1*01":"SFDVKD","TRBV24-1*02":"SFDVKD","TRBV24/OR9-2*01":"SFDVKD","TRBV25-1*01":"SYGVNS","TRBV26*01":"SPGTGS","TRBV26/OR9-2*01":"SPGTGS","TRBV26/OR9-2*02":"SPGTGS","TRBV27*01":"SMNVEV","TRBV28*01":"SYDVKM","TRBV29-1*01":"ANQGSEA","TRBV29-1*02":"ANQGSEA","TRBV29-1*03":"ANQGSEA","TRBV29/OR9-2*01":"ANQGSEA","TRBV29/OR9-2*02":"ANQGSEA","TRBV3-1*01":"YNNKEL","TRBV3-1*02":"YNNKEI","TRBV3-2*01":"YSNKEP","TRBV3-2*02":"YSNKEP","TRBV3-2*03":"YSNKEP","TRBV30*01":"SVGIG","TRBV30*02":"SVGIG","TRBV30*03":"SVGIG","TRBV30*04":"SIGID","TRBV30*05":"SVGIG","TRBV4-1*01":"YSYEKL","TRBV4-1*02":"YSYEKL","TRBV4-2*01":"YNFKEQ","TRBV4-2*02":"YNFKEQ","TRBV4-3*01":"YSLEER","TRBV4-3*02":"YSLEER","TRBV4-3*03":"YSLEER","TRBV4-3*04":"YSLEER","TRBV5-1*01":"YFSETQ","TRBV5-1*02":"YFSETQ","TRBV5-3*01":"YANELR","TRBV5-3*02":"YANELR","TRBV5-4*01":"YYREEE","TRBV5-4*02":"YYREEE","TRBV5-4*03":"YYREEE","TRBV5-4*04":"YYREEE","TRBV5-5*01":"YYEKEE","TRBV5-5*02":"YYEKEE","TRBV5-5*03":"YYEKEE","TRBV5-6*01":"YYEEEE","TRBV5-7*01":"YYEKEE","TRBV5-8*01":"YDEGEE","TRBV5-8*02":"YDEGEE","TRBV6-1*01":"SASEGT","TRBV6-2*01":"SVGEGT","TRBV6-3*01":"SVGEGT","TRBV6-4*01":"SNTAGT","TRBV6-4*02":"SNTAGT","TRBV6-5*01":"SVGAGI","TRBV6-6*01":"SVGAGI","TRBV6-6*02":"SVGAGI","TRBV6-6*03":"SVGAGI","TRBV6-6*04":"SVGAGI","TRBV6-6*05":"SVGAGI","TRBV6-7*01":"SVAAAL","TRBV6-8*01":"SAAAGT","TRBV6-9*01":"SVAAGI","TRBV7-1*01":"FQGKDA","TRBV7-2*01":"FQGNSA","TRBV7-2*02":"FQGNSA","TRBV7-2*03":"FQGNSA","TRBV7-2*04":"FQGNSA","TRBV7-3*01":"FQGTGA","TRBV7-3*02":"FQGTGA","TRBV7-3*03":"FQGTGA","TRBV7-3*04":"FQGTGA","TRBV7-3*05":"FQGTGA","TRBV7-4*01":"SQSDAQ","TRBV7-6*01":"FNYEAQ","TRBV7-6*02":"FNYEAQ","TRBV7-7*01":"FNYEAQ","TRBV7-7*02":"FNYEAQ","TRBV7-8*01":"FQNEAQ","TRBV7-8*02":"FQNEAQ","TRBV7-8*03":"FQNEAQ","TRBV7-9*01":"FQNEAQ","TRBV7-9*02":"FQNEAQ","TRBV7-9*03":"FQNEAQ","TRBV7-9*04":"FQNEAQ","TRBV7-9*05":"FQNEAQ","TRBV7-9*06":"FQNEAQ","TRBV7-9*07":"FQNEAQ","TRBV9*01":"YYNGEE","TRBV9*02":"YYNGEE","TRBV9*03":"YYNGEE"}



##############################
##MUS MUSCULUS
##############################
d_trav_cdr1_mus_musculus = {"TRAV1*01":"STSGFN","TRAV1*02":"STSGFN","TRAV10*01":"TDTASS","TRAV10*02":"TDTASS","TRAV10*03":"TDTASS","TRAV10*04":"TDTASS","TRAV10*05":"TDTASS","TRAV10D*01":"TDTASS","TRAV10D*02":"TDTASS","TRAV10D*03":"TDTASS","TRAV10N*01":"TDTASS","TRAV11*01":"SVTPDN","TRAV11*02":"SVTPDN","TRAV11D*01":"SVTPDN","TRAV11D*02":"SVTPDN","TRAV11N*01":"SVTPDN","TRAV12-1*01":"QTAYSDV","TRAV12-1*02":"QTTYSDV","TRAV12-1*03":"QTAYSDV","TRAV12-1*04":"QTAYSDV","TRAV12-1*05":"QTAYSDV","TRAV12-1*06":"QTTYLTI","TRAV12-2*01":"QTAYST","TRAV12-2*02":"QSTYSP","TRAV12-3*01":"QTIYSNP","TRAV12-3*02":"QTTYSNP","TRAV12-3*03":"QTIYSNP","TRAV12-3*04":"QTIYSHP","TRAV12-3*05":"QTIYSNA","TRAV12D-1*01":"QTTYLTI","TRAV12D-1*02":"QTTYLTI","TRAV12D-1*03":"","TRAV12D-1*04":"QTTYLTI","TRAV12D-1*05":"QTTYSNI","TRAV12D-1*06":"QTAYSDV","TRAV12D-2*01":"QSTYSP","TRAV12D-2*02":"QTTYSP","TRAV12D-2*03":"QSTYSP","TRAV12D-2*04":"QTTYSP","TRAV12D-2*05":"QTTYSP","TRAV12D-3*01":"QTIYSNP","TRAV12D-3*02":"QTIYSNA","TRAV12D-3*03":"QTIYSNA","TRAV12D-3*04":"QTIYSNP","TRAV12N-1*01":"QTAYSDV","TRAV12N-2*01":"QTTYSP","TRAV12N-3*01":"QTIYSNP","TRAV13-1*01":"STSLN","TRAV13-1*02":"STSLN","TRAV13-2*01":"SSTAT","TRAV13-2*02":"SSTAT","TRAV13-2*03":"SSTAT","TRAV13-3*01":"STTLN","TRAV13-3*02":"STTLN","TRAV13-4/DV7*01":"SSTAT","TRAV13-4/DV7*02":"SSTAT","TRAV13-4/DV7*03":"SSTAT","TRAV13-5*01":"SISTN","TRAV13D-1*01":"STSLN","TRAV13D-1*02":"STSLN","TRAV13D-1*03":"","TRAV13D-1*04":"STSLN","TRAV13D-2*01":"SSTAT","TRAV13D-2*02":"SSTVT","TRAV13D-2*03":"SSTAT","TRAV13D-3*01":"STTLN","TRAV13D-3*02":"STTLN","TRAV13D-4*01":"SIFTN","TRAV13D-4*02":"SIFTN","TRAV13D-4*03":"SSTAT","TRAV13N-1*01":"STSLN","TRAV13N-2*01":"SSTAT","TRAV13N-3*01":"STTLN","TRAV13N-4*01":"SIFTN","TRAV14-1*01":"EDSTFN","TRAV14-1*02":"EDSTFN","TRAV14-1*03":"EDSTFN","TRAV14-2*01":"EDSTFD","TRAV14-2*02":"EDSTFD","TRAV14-2*03":"EDSTFD","TRAV14-3*01":"ENSAFD","TRAV14-3*02":"ENSAFD","TRAV14-3*03":"ENSAFD","TRAV14-3*04":"ENSAFD","TRAV14-3*05":"ENSAFD","TRAV14D-1*01":"EDSTFN","TRAV14D-1*02":"EDSTFN","TRAV14D-2*01":"EDSTFD","TRAV14D-2*02":"STFD","TRAV14D-2*03":"EDSTFD","TRAV14D-3/DV8*01":"ENSAFD","TRAV14D-3/DV8*02":"ENSAFD","TRAV14D-3/DV8*03":"ENSAFD","TRAV14D-3/DV8*04":"ENSAFD","TRAV14D-3/DV8*05":"ENSAFD","TRAV14D-3/DV8*06":"ENSAFD","TRAV14D-3/DV8*07":"ENSAFD","TRAV14D-3/DV8*08":"ENSAFD","TRAV14N-1*01":"EDSTFN","TRAV14N-2*01":"EDSTFD","TRAV14N-3*01":"ENSAFD","TRAV15-1/DV6-1*01":"KTSQVLY","TRAV15-1/DV6-1*02":"KTSQVLY","TRAV15-2/DV6-2*01":"ETSEYFY","TRAV15-2/DV6-2*02":"ETSEYSY","TRAV15D-1/DV6D-1*01":"ETSQVLY","TRAV15D-1/DV6D-1*02":"ETSQVLY","TRAV15D-1/DV6D-1*03":"KTSQVLY","TRAV15D-1/DV6D-1*04":"ETSQVLY","TRAV15D-1/DV6D-1*05":"ETRQVLY","TRAV15D-1/DV6D-1*06":"ETSQVLY","TRAV15D-1/DV6D-1*07":"ETSQVLY","TRAV15D-2/DV6D-2*01":"ETSEYFY","TRAV15D-2/DV6D-2*02":"ETSEYFY","TRAV15D-2/DV6D-2*03":"ETSEYFY","TRAV15D-2/DV6D-2*04":"ETSEYFY","TRAV15D-2/DV6D-2*05":"ETSEYSY","TRAV15N-1*01":"ETSQVLY","TRAV15N-2*01":"ETSEYFY","TRAV16*01":"ETQDSSY","TRAV16*02":"ETQDSSY","TRAV16*03":"ETRESSY","TRAV16*04":"ETRESSY","TRAV16*05":"ETRESSY","TRAV16*06":"ETRDSSY","TRAV16D/DV11*01":"ETQDSSY","TRAV16D/DV11*02":"ETQDSSY","TRAV16D/DV11*03":"ETRDSSY","TRAV16N*01":"ETRDSSY","TRAV17*01":"SYSAAP","TRAV17*02":"SYSAAP","TRAV18*01":"STTFP","TRAV18*02":"STTFP","TRAV19*01":"ENDMFD","TRAV19*03":"ENDMFD","TRAV2*01":"TNIATSE","TRAV20*01":"TNAATN","TRAV20*02":"TNAATN","TRAV21/DV12*01":"ATISGNE","TRAV21/DV12*02":"ATISGNE","TRAV21/DV12*03":"ATISGNE","TRAV3-1*01":"TDSATA","TRAV3-1*02":"TDSATA","TRAV3-1*03":"TDSATA","TRAV3-3*01":"TDPNSY","TRAV3-4*01":"TDSATA","TRAV3-4*02":"TDSATA","TRAV3D-3*01":"TDPNSY","TRAV3D-3*02":"TDPNSY","TRAV3N-3*01":"TDPNSY","TRAV4-2*01":"STTMK","TRAV4-2*02":"STTMK","TRAV4-3*01":"SIATT","TRAV4-3*02":"SIATT","TRAV4-3*03":"SIAAT","TRAV4-4/DV10*01":"TTTMR","TRAV4-4/DV10*02":"TTTMR","TRAV4D-2*01":"STTMK","TRAV4D-2*02":"STTMK","TRAV4D-3*01":"SIAAT","TRAV4D-3*02":"SIAAT","TRAV4D-3*03":"SIAAT","TRAV4D-3*04":"SIAAT","TRAV4D-3*06":"SIAAT","TRAV4D-4*01":"TTTTR","TRAV4D-4*02":"TTTMR","TRAV4D-4*03":"TTTMR","TRAV4D-4*04":"TTTTR","TRAV4N-3*01":"SIAAT","TRAV4N-4*01":"TTTMR","TRAV5-1*01":"TDSASV","TRAV5-1*02":"TDSASV","TRAV5-2*01":"VNNASL","TRAV5-2*02":"VNNASL","TRAV5-4*01":"ENSASN","TRAV5-4*02":"EDSASN","TRAV5D-2*01":"VNNALL","TRAV5D-2*02":"VNNALL","TRAV5D-4*01":"ENSASN","TRAV5D-4*02":"EDSASN","TRAV5D-4*03":"ENSASN","TRAV5D-4*04":"EDSASN","TRAV5D-4*05":"ENSASN","TRAV5N-2*01":"VNNALL","TRAV5N-4*01":"ENSASN","TRAV6-1*01":"STTWYP","TRAV6-1*02":"STTWYP","TRAV6-1*03":"STTWYP","TRAV6-2*01":"STTGYP","TRAV6-2*02":"STTGYP","TRAV6-2*03":"STTGYP","TRAV6-3*01":"STTGYP","TRAV6-3*02":"STTGYP","TRAV6-4*01":"STTTYP","TRAV6-4*02":"STTTYP","TRAV6-4*03":"STTTYP","TRAV6-5*01":"ETKQYP","TRAV6-5*02":"ETKQYP","TRAV6-5*03":"ETKQYP","TRAV6-5*04":"ETKQYP","TRAV6-6*01":"STTSIAYP","TRAV6-6*02":"STTSIAYP","TRAV6-6*03":"LTTSIGYP","TRAV6-6*04":"SATSIAYP","TRAV6-7/DV9*01":"SASGYP","TRAV6-7/DV9*02":"SASGYP","TRAV6-7/DV9*03":"SASGYP","TRAV6-7/DV9*04":"SASGYP","TRAV6-7/DV9*06":"SASGYP","TRAV6-7/DV9*07":"SASGYP","TRAV6-7/DV9*08":"","TRAV6D-3*01":"STTGYP","TRAV6D-3*02":"STTGYP","TRAV6D-3*03":"STTGYP","TRAV6D-4*01":"STTTYP","TRAV6D-5*01":"ETKQYP","TRAV6D-5*02":"ETKQYP","TRAV6D-6*01":"SATSIAYP","TRAV6D-6*02":"SATSIAYP","TRAV6D-6*03":"SATSIGYP","TRAV6D-6*04":"SATSIGYP","TRAV6D-6*05":"SATSIGYP","TRAV6D-7*01":"SASGYP","TRAV6D-7*02":"SASGYP","TRAV6D-7*03":"TASGYP","TRAV6D-7*04":"SASGYP","TRAV6N-5*01":"ETKQYP","TRAV6N-6*01":"SATSIGYP","TRAV6N-7*01":"SASGYP","TRAV7-1*01":"SDRNSQ","TRAV7-1*02":"SDRNSQ","TRAV7-2*01":"SDRNVD","TRAV7-2*02":"SDRNVD","TRAV7-3*01":"SDSASQ","TRAV7-3*02":"","TRAV7-3*03":"SDSASQ","TRAV7-3*04":"SDSASQ","TRAV7-4*01":"SDRNFQ","TRAV7-4*02":"SDRNFQ","TRAV7-5*01":"SDGTSD","TRAV7-5*02":"","TRAV7-5*03":"SDGTSN","TRAV7-6*01":"SNSASQ","TRAV7-6*02":"SDSASQ","TRAV7D-2*01":"SDRNVD","TRAV7D-2*02":"SDRNVD","TRAV7D-2*03":"","TRAV7D-3*01":"SDSASQ","TRAV7D-3*02":"SDSASQ","TRAV7D-3*03":"SDSASQ","TRAV7D-4*01":"SDRNFQ","TRAV7D-4*02":"SDRNFQ","TRAV7D-4*03":"SDRNFQ","TRAV7D-5*01":"SDGTSD","TRAV7D-5*02":"SDRSSD","TRAV7D-6*01":"SDSASQ","TRAV7D-6*02":"SNSASQ","TRAV7N-4*01":"SDRNFQ","TRAV7N-5*01":"SDRSSD","TRAV7N-6*01":"SNSASQ","TRAV8-1*01":"KTSIT","TRAV8-1*02":"","TRAV8-1*03":"KTSIT","TRAV8-2*01":"KTYTT","TRAV8-2*02":"KTYTT","TRAV8D-1*01":"KTSIT","TRAV8D-1*02":"TTSIT","TRAV8D-2*01":"KTYTT","TRAV8D-2*02":"KTYTT","TRAV8D-2*03":"KTYTT","TRAV8N-2*01":"KTYTT","TRAV9-1*01":"SYGGSI","TRAV9-1*02":"SYGGSI","TRAV9-2*01":"SYSGTP","TRAV9-2*02":"SYSGTP","TRAV9-3*01":"SSSVTP","TRAV9-3*02":"SSSVTP","TRAV9-3*03":"SSSVTP","TRAV9-4*01":"SYSATP","TRAV9-4*02":"SYSGTP","TRAV9D-1*01":"SYGGSI","TRAV9D-1*02":"SYGGSI","TRAV9D-1*03":"SYGGSI","TRAV9D-2*01":"SYSGTP","TRAV9D-2*02":"SYSGTP","TRAV9D-2*03":"SYSGTP","TRAV9D-2*05":"SSSGTP","TRAV9D-3*01":"SYSATP","TRAV9D-3*02":"SYSATP","TRAV9D-3*03":"SYFGTP","TRAV9D-4*01":"SYSGTP","TRAV9D-4*03":"","TRAV9D-4*04":"SYSGTP","TRAV9N-2*01":"SSSGTP","TRAV9N-3*01":"SYFGTP","TRAV9N-4*01":"SYSATP"}

d_trav_cdr2_mus_musculus = { "TRAV1*01":"YVVLDG","TRAV1*02":"YVVLDG","TRAV10*01":"DIRSNVD","TRAV10*02":"DIRSNVD","TRAV10*03":"DIRSNVD","TRAV10*04":"DIRSNVD","TRAV10*05":"DIRSNVD","TRAV10D*01":"DIRSNVD","TRAV10D*02":"DIRSNVD","TRAV10D*03":"DIRSNVD","TRAV10N*01":"DIRSNVD","TRAV11*01":"VLVHEND","TRAV11*02":"VLVDQKD","TRAV11D*01":"VLVHEND","TRAV11D*02":"VLVDQKD","TRAV11N*01":"VLVHQKD","TRAV12-1*01":"RSSTDNK","TRAV12-1*02":"RSSTDNK","TRAV12-1*03":"RSSTDNK","TRAV12-1*04":"RSSTDNK","TRAV12-1*05":"RSSTDNK","TRAV12-1*06":"KSSTDNK","TRAV12-2*01":"KSSTDNK","TRAV12-2*02":"KSFTDNK","TRAV12-3*01":"KSSTDNK","TRAV12-3*02":"RSSTDNK","TRAV12-3*03":"KSSTDNK","TRAV12-3*04":"KSSTDNK","TRAV12-3*05":"KSSTDNK","TRAV12D-1*01":"KSSTDNK","TRAV12D-1*02":"RSSTDNK","TRAV12D-1*03":"KSSTDNK","TRAV12D-1*04":"KSSTDNK","TRAV12D-1*05":"KSSTDNK","TRAV12D-1*06":"RSSTDNK","TRAV12D-2*01":"KSFTDNK","TRAV12D-2*02":"KSSTDNK","TRAV12D-2*03":"KSFTDNK","TRAV12D-2*04":"KSSTDNK","TRAV12D-2*05":"KSSTDNK","TRAV12D-3*01":"KNFTDNK","TRAV12D-3*02":"RSSTDNK","TRAV12D-3*03":"RSSTDNK","TRAV12D-3*04":"KSFTDNK","TRAV12N-1*01":"RSSTDNK","TRAV12N-2*01":"KSSTDNK","TRAV12N-3*01":"KSFTDNK","TRAV13-1*01":"YNPSG","TRAV13-1*02":"YNPSG","TRAV13-2*01":"SNPSG","TRAV13-2*02":"SNPSG","TRAV13-2*03":"YNPSG","TRAV13-3*01":"YSPSWA","TRAV13-3*02":"YSPSWA","TRAV13-4/DV7*01":"YNPSG","TRAV13-4/DV7*02":"SNPSG","TRAV13-4/DV7*03":"YNPSG","TRAV13-5*01":"YIPG","TRAV13D-1*01":"YNPSG","TRAV13D-1*02":"YNPSG","TRAV13D-1*03":"YNPSG","TRAV13D-1*04":"YNPSG","TRAV13D-2*01":"YNPSG","TRAV13D-2*02":"YNPSG","TRAV13D-2*03":"SNPSG","TRAV13D-3*01":"YSPSWA","TRAV13D-3*02":"YSPSWA","TRAV13D-4*01":"YNPSG","TRAV13D-4*02":"YNPSG","TRAV13D-4*03":"YNPSG","TRAV13N-1*01":"YNPSG","TRAV13N-2*01":"SNPSG","TRAV13N-3*01":"YSPSWA","TRAV13N-4*01":"YNPSG","TRAV14-1*01":"SILSVSD","TRAV14-1*02":"SISSVSD","TRAV14-1*03":"SISSVSD","TRAV14-2*01":"AIRPVSN","TRAV14-2*02":"AIRPVSN","TRAV14-2*03":"AIRPVSN","TRAV14-3*01":"SILSVSD","TRAV14-3*02":"AILSVSN","TRAV14-3*03":"SILSVSD","TRAV14-3*04":"AIRSVSD","TRAV14-3*05":"SILSVSN","TRAV14D-1*01":"SIRSVSD","TRAV14D-1*02":"SILSVSD","TRAV14D-2*01":"AISLVSN","TRAV14D-2*02":"AISLVSN","TRAV14D-2*03":"AIRPVSN","TRAV14D-3/DV8*01":"AIRSVSD","TRAV14D-3/DV8*02":"AIRSVSD","TRAV14D-3/DV8*03":"AIRSVSD","TRAV14D-3/DV8*04":"AIRSVSD","TRAV14D-3/DV8*05":"FIRSVSD","TRAV14D-3/DV8*06":"AIRSVSD","TRAV14D-3/DV8*07":"AIRSVSD","TRAV14D-3/DV8*08":"SILSVSD","TRAV14N-1*01":"SIRSVSD","TRAV14N-2*01":"AIRPVSN","TRAV14N-3*01":"AIRSVSD","TRAV15-1/DV6-1*01":"RQMPSTIA","TRAV15-1/DV6-1*02":"RQMPSTIA","TRAV15-2/DV6-2*01":"YQTSFDTQ","TRAV15-2/DV6-2*02":"YQPSFDTQ","TRAV15D-1/DV6D-1*01":"RQMSSSTA","TRAV15D-1/DV6D-1*02":"RQMSSSTA","TRAV15D-1/DV6D-1*03":"RQMPSTIA","TRAV15D-1/DV6D-1*04":"RQTSSSTA","TRAV15D-1/DV6D-1*05":"RQTSSSTA","TRAV15D-1/DV6D-1*06":"RQTSSSTA","TRAV15D-1/DV6D-1*07":"RQTSSSTA","TRAV15D-2/DV6D-2*01":"YQTSFDTQ","TRAV15D-2/DV6D-2*02":"YQPSFDTQ","TRAV15D-2/DV6D-2*03":"YQPSFDTQ","TRAV15D-2/DV6D-2*04":"YQTSFDTQ","TRAV15D-2/DV6D-2*05":"YQPSFDTQ","TRAV15N-1*01":"RQTSSSTA","TRAV15N-2*01":"YQPSFDTQ","TRAV16*01":"RQDSYKKE","TRAV16*02":"RQDSYKKE","TRAV16*03":"RQDSCEKE","TRAV16*04":"RQDSYKKE","TRAV16*05":"RQDSYKKE","TRAV16*06":"RQDSYKKE","TRAV16D/DV11*01":"RQDSYKKE","TRAV16D/DV11*02":"RQDSYKKE","TRAV16D/DV11*03":"RQDSYKKE","TRAV16N*01":"RQDSYKKE","TRAV17*01":"KYITGDAV","TRAV17*02":"KYITGDTV","TRAV18*01":"TLVKSGE","TRAV18*02":"TLVKSGE","TRAV19*01":"SVRSNVD","TRAV19*03":"SVRSNVD","TRAV2*01":"QGYKD","TRAV20*01":"DIRSNVN","TRAV20*02":"DIRSNVN","TRAV21/DV12*01":"HGLQQ","TRAV21/DV12*02":"HGLQQ","TRAV21/DV12*03":"HGLQQ","TRAV3-1*01":"SVLSNVD","TRAV3-1*02":"SVLSNVD","TRAV3-1*03":"SVLSNVD","TRAV3-3*01":"KVFSSTE","TRAV3-4*01":"SVFSNVD","TRAV3-4*02":"SVFSNVD","TRAV3D-3*01":"KVFSSTE","TRAV3D-3*02":"KVFSSTE","TRAV3N-3*01":"KVFSSTE","TRAV4-2*01":"YLAQG","TRAV4-2*02":"YLAQG","TRAV4-3*01":"YLVPG","TRAV4-3*02":"YLVPG","TRAV4-3*03":"YLVPG","TRAV4-4/DV10*01":"YLASG","TRAV4-4/DV10*02":"YLASG","TRAV4D-2*01":"YLAQG","TRAV4D-2*02":"YLAQG","TRAV4D-3*01":"YLVPG","TRAV4D-3*02":"YLVPG","TRAV4D-3*03":"YLVPG","TRAV4D-3*04":"YLVPG","TRAV4D-3*06":"YLVPG","TRAV4D-4*01":"YLASG","TRAV4D-4*02":"YLASG","TRAV4D-4*03":"YLASG","TRAV4D-4*04":"YLASG","TRAV4N-3*01":"YLVPG","TRAV4N-4*01":"YLASG","TRAV5-1*01":"DIRSNME","TRAV5-1*02":"DIRSNME","TRAV5-2*01":"DIR*NME","TRAV5-2*02":"DIR*NME","TRAV5-4*01":"DIRSNME","TRAV5-4*02":"DIRSNME","TRAV5D-2*01":"DIC*NME","TRAV5D-2*02":"DIC*NME","TRAV5D-4*01":"DIRSNME","TRAV5D-4*02":"DIRSNME","TRAV5D-4*03":"DIRSNME","TRAV5D-4*04":"DIRSNME","TRAV5D-4*05":"DIRSNME","TRAV5N-2*01":"DIC*NME","TRAV5N-4*01":"DIRSNME","TRAV6-1*01":"KVTTANN","TRAV6-1*02":"KVTTANN","TRAV6-1*03":"KVTTANN","TRAV6-2*01":"KVTTANN","TRAV6-2*02":"KVTTANN","TRAV6-2*03":"KVTTANN","TRAV6-3*01":"QVTTANN","TRAV6-3*02":"QVTTANN","TRAV6-4*01":"KVTTANN","TRAV6-4*02":"KETTANN","TRAV6-4*03":"KVTTANN","TRAV6-5*01":"KVPKANE","TRAV6-5*02":"KVPKANE","TRAV6-5*03":"KVPKANE","TRAV6-5*04":"KVPKANE","TRAV6-6*01":"KVITAGQ","TRAV6-6*02":"KVITAGQ","TRAV6-6*03":"KVITAGQ","TRAV6-6*04":"KVITAGQ","TRAV6-7/DV9*01":"RASRDKE","TRAV6-7/DV9*02":"RASRDKE","TRAV6-7/DV9*03":"RASRDKE","TRAV6-7/DV9*04":"RASRDKE","TRAV6-7/DV9*06":"RASRDKE","TRAV6-7/DV9*07":"RASRDKE","TRAV6-7/DV9*08":"RASRDKE","TRAV6D-3*01":"QVTTANN","TRAV6D-3*02":"QVTTANN","TRAV6D-3*03":"QVTTANN","TRAV6D-4*01":"KVTTANN","TRAV6D-5*01":"KVPKANE","TRAV6D-5*02":"KVPKANE","TRAV6D-6*01":"KVITAGQ","TRAV6D-6*02":"KVITAGQ","TRAV6D-6*03":"KVITAGQ","TRAV6D-6*04":"KVITAGQ","TRAV6D-6*05":"KVITAGQ","TRAV6D-7*01":"RASRDKE","TRAV6D-7*02":"RASRDKE","TRAV6D-7*03":"RASRDKE","TRAV6D-7*04":"RASRDKE","TRAV6N-5*01":"KVPKANE","TRAV6N-6*01":"KVITAGQ","TRAV6N-7*01":"RASRDKE","TRAV7-1*01":"SIFSNG","TRAV7-1*02":"SIFSNG","TRAV7-2*01":"AIFSNG","TRAV7-2*02":"SIFSNG","TRAV7-3*01":"SIFSNG","TRAV7-3*02":"SIFSNG","TRAV7-3*03":"SIFSNG","TRAV7-3*04":"SIFSNG","TRAV7-4*01":"SIFSDG","TRAV7-4*02":"SIFSDG","TRAV7-5*01":"SIFSDG","TRAV7-5*02":"SIFSDG","TRAV7-5*03":"SIFSDG","TRAV7-6*01":"SIFSNG","TRAV7-6*02":"SIFSNG","TRAV7D-2*01":"SIFSNG","TRAV7D-2*02":"SIFSNG","TRAV7D-2*03":"","TRAV7D-3*01":"SIFSNG","TRAV7D-3*02":"SIFSNG","TRAV7D-3*03":"SIFSNG","TRAV7D-4*01":"SIFSDG","TRAV7D-4*02":"SIFSDG","TRAV7D-4*03":"SIFSDG","TRAV7D-5*01":"SIFSDG","TRAV7D-5*02":"SIFSDG","TRAV7D-6*01":"SIFSNG","TRAV7D-6*02":"SIFSNG","TRAV7N-4*01":"SIFSDG","TRAV7N-5*01":"SIFSDG","TRAV7N-6*01":"SIFSNG","TRAV8-1*01":"LIRSNER","TRAV8-1*02":"RSNER","TRAV8-1*03":"LIRSNER","TRAV8-2*01":"LIRSNER","TRAV8-2*02":"LIRSNER","TRAV8D-1*01":"LIRSNER","TRAV8D-1*02":"LIRSNER","TRAV8D-2*01":"LIRSNER","TRAV8D-2*02":"LIRSNER","TRAV8D-2*03":"LIRSNER","TRAV8N-2*01":"LIRSNER","TRAV9-1*01":"KYYSGNPV","TRAV9-1*02":"KYYSGNPV","TRAV9-2*01":"KYYSGDPV","TRAV9-2*02":"KYYSGDPV","TRAV9-3*01":"KYYSGDPV","TRAV9-3*02":"KYYSGDPV","TRAV9-3*03":"KYYSGDPV","TRAV9-4*01":"KYYSGDPV","TRAV9-4*02":"KYYSGDPV","TRAV9D-1*01":"KYYSGNPV","TRAV9D-1*02":"KYYSGNPV","TRAV9D-1*03":"KYYSGNPV","TRAV9D-2*01":"KYYSGDPV","TRAV9D-2*02":"KYYSGDPV","TRAV9D-2*03":"KYYSGDPV","TRAV9D-2*05":"KYYSGDPV","TRAV9D-3*01":"KYYSGDPV","TRAV9D-3*02":"KYYSGDPV","TRAV9D-3*03":"KYYPGDPV","TRAV9D-4*01":"KYYSGDPV","TRAV9D-4*03":"KYYSGDPV","TRAV9D-4*04":"KYYSGDPV","TRAV9N-2*01":"KYYSGDPV","TRAV9N-3*01":"KYYPGDPV","TRAV9N-4*01":"KYYSGDPV"}

d_trbv_cdr1_mus_musculus = {"TRBV1*01":"NSQYPW","TRBV1*02":"NSQYPW","TRBV10*01":"MNHYR","TRBV12-1*01":"SGHSN","TRBV12-1*02":"SGHSN","TRBV12-2*01":"SGHLS","TRBV12-2*02":"SGHLS","TRBV13-1*01":"NSHNY","TRBV13-1*02":"NSHNY","TRBV13-2*01":"NNHNN","TRBV13-2*02":"NNHNN","TRBV13-2*03":"NNHNN","TRBV13-2*04":"NNHNN","TRBV13-2*05":"NNHNN","TRBV13-3*01":"NNHDY","TRBV14*01":"SGHDT","TRBV15*01":"SGHND","TRBV16*01":"SGHSA","TRBV16*02":"SGHSA","TRBV16*03":"SGHSA","TRBV16*04":"SGHSA","TRBV17*01":"MNHDT","TRBV19*01":"FNHDT","TRBV19*02":"FNHDT","TRBV19*03":"FNHDS","TRBV2*01":"LGHNA","TRBV20*01":"GFQATS","TRBV20*02":"GFQATS","TRBV21*01":"NGHSY","TRBV23*01":"KGHTA","TRBV24*01":"KGHTA","TRBV24*02":"KGHTA","TRBV24*03":"KGHTA","TRBV24*04":"KGHTA","TRBV26*01":"KGHPV","TRBV26*02":"KGHPF","TRBV29*01":"MSHET","TRBV29*02":"MSHET","TRBV3*01":"SNHLY","TRBV3*02":"SNHLY","TRBV30*01":"SQVVS","TRBV31*01":"GKSSPN","TRBV31*02":"GKSSPN","TRBV4*01":"LGHDT","TRBV4*02":"LDHNT","TRBV5*01":"LGHNA","TRBV5*02":"LGHNA","TRBV5*03":"LGHNA","TRBV5*04":"LGHNA","TRBV5*05":"LGHNA","TRBV8*01":"MKHDS","TRBV9*01":"SGPTG","TRBV1*01":"NSQYPW","TRBV12-1*01":"SGHEG","TRBV12-2*01":"SGHAA","TRBV15*01":"MNHDS","TRBV16*01":"KGHSY","TRBV18*01":"KGHVY","TRBV19*01":"FNHDY","TRBV20*01":"DLQVQT","TRBV21*01":"KGHSY","TRBV22*01":"LRYNA","TRBV24*01":"KSHNF","TRBV25*01":"MGYEN","TRBV26*01":"MNYVL","TRBV27*01":"MDHDV","TRBV28*01":"KDHGR","TRBV29*01":"TQVSL","TRBV3*01":"LGHDT","TRBV30*01":"GTSVPY","TRBV4-1*01":"LGHNA","TRBV4-2*01":"LGHNA","TRBV5-2*01":"SGHLS","TRBV5-4*01":"SGHNS","TRBV6*01":"MNHNS","TRBV7-1*01":"SGHAV","TRBV7-2*01":"SGHTV","TRBV8*01":"MNHFA"}

d_trbv_cdr2_mus_musculus = {"TRBV1*01":"LRSPGD","TRBV1*02":"LRSPRD","TRBV10*01":"SVGTDR","TRBV12-1*01":"HYEKVE","TRBV12-1*02":"HYEKVE","TRBV12-2*01":"HYDKME","TRBV12-2*02":"HYDKME","TRBV13-1*01":"SYGAGN","TRBV13-1*02":"SYGAGN","TRBV13-2*01":"SYGAGS","TRBV13-2*02":"SYGAGS","TRBV13-2*03":"SYGAGS","TRBV13-2*04":"SYGAGS","TRBV13-2*05":"SYGADS","TRBV13-3*01":"SYVADS","TRBV14*01":"FRDEAV","TRBV15*01":"FRSKSL","TRBV16*01":"FRNQAP","TRBV16*02":"FRNQAP","TRBV16*03":"FRNQAP","TRBV16*04":"FRNQAP","TRBV17*01":"YYDKIL","TRBV19*01":"SITEND","TRBV19*02":"SITEND","TRBV19*03":"SITEND","TRBV2*01":"YSYQKL","TRBV20*01":"STVNSAI","TRBV20*02":"STVNSAI","TRBV21*01":"FQNEDI","TRBV23*01":"FQNQQP","TRBV24*01":"FRNEEI","TRBV24*02":"FRNEEI","TRBV24*03":"FRNEEI","TRBV24*04":"FRNEEI","TRBV26*01":"FQNQEV","TRBV26*02":"FQNQEV","TRBV29*01":"SYDVDS","TRBV29*02":"SYDVDS","TRBV3*01":"FYNGKV","TRBV3*02":"FYNVKV","TRBV30*01":"ANEGSEA","TRBV31*01":"SITVG","TRBV31*02":"SITVG","TRBV4*01":"YNNKQL","TRBV4*02":"YNNKQL","TRBV5*01":"YNLKQL","TRBV5*02":"YNLKQL","TRBV5*03":"YNLKQL","TRBV5*04":"YNLKQL","TRBV5*05":"YSVKQL","TRBV8*01":"SYDAGI","TRBV9*01":"FQGEFI","TRBV1*01":"LRSPGD","TRBV12-1*01":"FNNEAP","TRBV12-2*01":"FNNQAP","TRBV15*01":"YYDKNF","TRBV16*01":"FQNDAI","TRBV18*01":"LQNAQT","TRBV19*01":"SPLKDD","TRBV20*01":"SNVGSSA","TRBV21*01":"LQDKDI","TRBV22*01":"STVEKD","TRBV24*01":"SHISD","TRBV25*01":"SYGVNN","TRBV26*01":"STGARN","TRBV27*01":"SRNVKF","TRBV28*01":"SYGVDN","TRBV29*01":"ANQGMEA","TRBV3*01":"YNNKDL","TRBV30*01":"SVNVD","TRBV4-1*01":"YSYKDL","TRBV4-2*01":"YNYKNL","TRBV5-2*01":"YYDRKE","TRBV5-4*01":"YFAQAP","TRBV6*01":"SVGPAPLSGA","TRBV7-1*01":"FQNADA","TRBV7-2*01":"FQNTDA","TRBV8*01":"SSDSPS"}


###map correct V,J gene
map_correct_homo_sapiens_TRAV={"TRAV38-2DV8":"TRAV38-2/DV8","TRAV14DV4":"TRAV14/DV4","TRAV23DV6":"TRAV23/DV6","TRAV29DV5":"TRAV29/DV5","TRAV36DV7":"TRAV36/DV7","TRAV2-01":"TRAV2","TRAV3-01":"TRAV3","TRAV1-01":"TRAV1-1","TRAV6-01":"TRAV6","TRAV5-01":"TRAV5","TRAV38":"TRAV38-1","TCRAV41":"TRAV41","TCRAV19":"TRAV19","TRAV-2":"TRAV2","TRAV14":"TRAV14/DV4","TRAV1-4":"TRAV1-1","TRAV15":"TRAV15","TRAV23":"TRAV23/DV6","TRAV2-2":"TRAV2","TRAV12":"TRAV12-1","TRAV26":"TRAV26-1","TRAV13":"TRAV13-1","TRAV9":"TRAV9-1","TRAV8":"TRAV8-1","TRAV10-01":"TRAV10","TRAV21-01":"TRAV21","TRAV41-01":"TRAV41","TRAV16-01":"TRAV16","TRAV36":"TRAV36/DV7","TRAV29":"TRAV29/DV5","TRAV38-2":"TRAV38-2/DV8","TRAV1":"TRAV1-1","mTRDV2-2":"mTRDV2-2","TRAV2-1":"TRAV2","TRAV28":"TRAV28","TRAV12-4":"TRAV12-1","TRAV08-3":"TRAV8-3","TRAV121":"TRAV12-1","TRAV08-4":"TRAV8-4","TCRAV38-2/DV8":"TRAV38-2/DV8","TCRAV17":"TRAV17","TRAV21-2":"TRAV21","TRAV251":"TRAV25","TRDAV1":"TRAV1-1","TRAV21-1":"TRAV21","TRAV17-01":"TRAV17","TRAV35*02":"TRAV35*02","TRAV09-2":"TRAV9-2","TRAV01-2":"TRAV1-2","TRAV19-":"TRAV19","TRAV24-01":"TRAV24","TCRAV23/DV6":"TRAV23/DV6","TCRAV38-1":"TRAV38-1","TCRAV1-1":"TRAV1-1","TCRAV12-1":"TRAV12-1","TCRAV21":"TRAV21","TCRAV3":"TRAV3","TRAV20-01":"TRAV20","TRAV3-1":"TRAV3","TRAV4-1":"TRAV4","TRAV35-1":"TRAV35"}
map_correct_mus_musculus_TRAV={"TRAV14D-3-DV8":"TRAV14D-3/DV8","TRAV21-DV12":"TRAV21/DV12","TRAV15D-1-DV6D-1":"TRAV15D-1/DV6D-1","TRAV16D-DV11":"TRAV16D/DV11","TRAV4-4-DV10":"TRAV4-4/DV10","TRAV15D-2-DV6D-2":"TRAV15D-2/DV6D-2","TRAV6-7-DV9":"TRAV6-7/DV9","TRAV15-2-DV6-2":"TRAV15-2/DV6-2","TRAV15-1-DV6-1":"TRAV15-1/DV6-1","TRAV13-4-DV7":"TRAV13-4/DV7","TRAV1-01":"TRAV1","TRAV2-01":"TRAV2","TRAV3":"TRAV3-1","TRAV6":"TRAV6-1","TRAV5":"TRAV5-1","TRAV7":"TRAV7-1","TRAV8":"TRAV8-1","TRAV21":"TRAV21/DV12","TRAV15":"TRAV15-1/DV6-1","TRAV4":"TRAV4-2","TRAV22-1":"TRAV22-1","TRAV11-1":"TRAV11","TRAV8-4":"TRAV8-1","TRAV11-4":"TRAV11","TRAV18-2":"TRAV18"}
map_correct_homo_sapiens_TRAJ = { "TRAJ5-01":"TRAJ5","TRAJ3-01":"TRAJ3","TRAJ4-01":"TRAJ4","TRAJ2-01":"TRAJ2","TRAJ1-01":"TRAJ1","TRAJ6-01":"TRAJ6","TRAJ8-01":"TRAJ8","TRAJ2-1":"TRAJ2","TRAJ3-1":"TRAJ3","TCRAJ58":"TRAJ58","TCRAJ6":"TRAJ6","TRAJ9-01":"TRAJ9","TCRAJ12":"TRAJ12","TRAJ53*02":"TRAJ53","TCRAJ26":"TRAJ26","TCRAJ44":"TRAJ44","TCRAJ45":"TRAJ45","TCRAJ28":"TRAJ28","TRAJ53-1":"TRAJ53","TRAJ4-1":"TRAJ4","TRAJ44-1":"TRAJ44","TRAJ37-1":"TRAJ37","TRAJ32-1":"TRAJ32","TRAJ33-1":"TRAJ33","TRAJ21-1":"TRAJ21","TRAJ34-1":"TRAJ34","TRAJ24-1":"TRAJ24","TRAJ20-1":"TRAJ20","TRAJ47-1":"TRAJ47","TRAJ37-2":"TRAJ37"}
map_correct_mus_musculus_TRAJ = {"TRAJ3-01":"TRAJ3","TRAJ2-01":"TRAJ2","TRAJ4-01":"TRAJ4","TRAJ5-01":"TRAJ5","TRAJ1-01":"TRAJ1-01","TRAJ9-01":"TRAJ9","TRAJ6-01":"TRAJ6","TRAJ14":"TRAJ14"}
map_correct_homo_sapiens_TRBV = { "TRBV2-01":"TRBV2","TRBV1-01":"TRBV1","TRBV9-01":"TRBV9","TRBV6-01":"TRBV6-1","TRBV7-01":"TRBV7-1","TRBV5-01":"TRBV5-1","TRBV4-01":"TRBV4-1","TRBV1-1":"TRBV1","TRBV29":"TRBV29-1","TRBV2-1":"TRBV2","TCRBV19":"TRBV19","TRBV5-04":"TRBV5-4","TRBV12-03":"TRBV12-3","TRBV12-04":"TRBV12-4","TRBV6-04":"TRBV6-4","TRBV6-06":"TRBV6-6","TRBV4-03":"TRBV4-3","TRBV6-05":"TRBV6-5","TRBV3-01":"TRBV3-1","TRBV6-03":"TRBV6-3","TRBV6-02":"TRBV6-2","TRBV7-02":"TRBV7-2","TRBV4-02":"TRBV4-2","TRBV5-08":"TRBV5-8","TRBV7-06":"TRBV7-6","TRBV5-06":"TRBV5-6","TRBV10-01":"TRBV10-1","TRBV10-02":"TRBV10-2","TRBV11-02":"TRBV11-2","TRBV10-03":"TRBV10-3","TRBV25-01":"TRBV25-1","TRBV29-01":"TRBV29-1","TRBV20-01":"TRBV20-1","TRBV7-08":"TRBV7-8","TRBV12":"TRBV12-1","TRBV20":"TRBV20-1","TRBV8":"TRBV8","TRBV7":"TRBV7-1","TRBV23":"TRBV23-1","TRBV3":"TRBV3-1","TRBV6":"TRBV6-1","TRBV5":"TRBV5-1","TRBV25":"TRBV25-1","TRBV10":"TRBV10-1","TRBV9-02":"TRBV9","TRBV24":"TRBV24-1","TRBV4":"TRBV4-1","TRBV11":"TRBV11-1","TRBV11-01":"TRBV11-1","TRBV5-05":"TRBV5-5","TRBV7-03":"TRBV7-3","TRBV24-01":"TRBV24-1","TRBV5-07":"TRBV5-7","TCRBV7-9*03":"TRBV7-9*03","TRBV23-01":"TRBV23-1","TRBV7-09":"TRBV7-9","TRBV11-03":"TRBV11-3","TCRBV7-3":"TRBV7-3","TRBV9-1":"TRBV9","TRBV15-02":"TRBV15"}
map_correct_mus_musculus_TRBV={"TRBV12-2+TRBV13-2":"TRBV12-2","TRBV1-01":"TRBV1","TRBV4-01":"TRBV4","TRBV5-01":"TRBV5","TRBV2-01":"TRBV2","TRBV3-01":"TRBV3","TRBV13":"TRBV13-1","TRBV7":"TRBV7-1","TRBV8-1":"TRBV8","TRBV8-2":"TRBV8","TRBV13-01":"TRBV13-1","TRBV8-3":"TRBV8","TRBV6S-19":"TRBV6S-19"}
map_correct_homo_sapiens_TRBJ={"TRBJ2-7":"TRBJ2-7","TCRBJ2-1":"TRBJ2-1","TCRBJ1-5":"TRBJ1-5","TRBJ1":"TRBJ1-1","TRBJ2":"TRBJ2-1","TRBJ5-1":"TRBJ5-1","TRBJ38-2/DV8":"TRBJ38-2/DV8","TCRBJ1-6*02":"TRBJ1-6*02","TRBJ5-6":"TRBJ5-6","TRBJ17-1":"TRBJ17-1","TRBJ19-1":"TRBJ19-1","TRBJ24-1":"TRBJ24-1","TCRBJ2-3":"TRBJ2-3","TCRBJ1-1":"TRBJ1-1","TRBJ10-1":"TRBJ10-1","TRBJ20-1":"TRBJ20-1"}
map_correct_mus_musculus_TRBJ={"TRBJ2":"TRBJ2-1","TRBJ1":"TRBJ1-1"}

